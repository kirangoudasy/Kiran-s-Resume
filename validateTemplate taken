_showPreviewDialog: function (payload) {

  const oExpiryDate = new sap.m.DatePicker({
    placeholder: "Select Expiry Date",
    change: function () {
      oUploadBtn.setEnabled(!!oExpiryDate.getValue() && !!oLoadTypeSelect.getSelectedKey());
    }
  });

  const oLoadTypeSelect = new sap.m.Select({
    items: [
      new sap.ui.core.Item({ key: "TRUNCATE", text: "Truncate" }),
      new sap.ui.core.Item({ key: "APPEND", text: "Append" })
    ],
    change: function () {
      oUploadBtn.setEnabled(!!oExpiryDate.getDateValue() && !!oLoadTypeSelect.getSelectedKey());
    }
  });

  const oForm = new sap.ui.layout.form.SimpleForm({
    editable: false,
    layout: "ResponsiveGridLayout",
    content: [
      new sap.m.Label({ text: "Module" }),
      new sap.m.Text({ text: payload.MODULE_NAME }),

      new sap.m.Label({ text: "Submodule" }),
      new sap.m.Text({ text: payload.SUB_MODULE_NAME }),

      new sap.m.Label({ text: "Template" }),
      new sap.m.Text({ text: payload.LOAD_TEMPLATE }),

      new sap.m.Label({ text: "File Name" }),
      new sap.m.Text({ text: payload.FILE_NAME }),

      new sap.m.Label({ text: "Expiry Date" }),
      oExpiryDate,

      new sap.m.Label({ text: "Load Type" }),
      oLoadTypeSelect
    ]
  });

  const oUploadBtn = new sap.m.Button({
    text: "Upload",
    enabled: false,
    press: async () => {

      oDialog.setBusy(true);

      const date = oExpiryDate.getDateValue();
      const yyyy = date.getFullYear();
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const dd = String(date.getDate()).padStart(2, '0');

      payload.EXPIRY_DATE = `${yyyy}-${mm}-${dd}`;
      payload.LOAD_TYPE = oLoadTypeSelect.getSelectedKey();

      try {
        // ðŸ”´ BACKEND CREATE â†’ RUNS GENERIC DATA VALIDATOR
        const listBinding = this.oModel.bindList("/ReportFileStorage");
        const context = await listBinding.create(payload);
        await context.created();

        // âœ… PROC PASSED
        sap.m.MessageBox.success("File uploaded and validated successfully");

        // refresh table
        const oTable = this.byId("fileTable");
        const oBindings = oTable.getBinding("rows");
        if (oBindings) oBindings.refresh();

        oDialog.close();

      } catch (error) {

        // âŒ PROC FAILED
        let message = "Upload failed during validation";

        if (error && error.responseText) {
          try {
            const odataError = JSON.parse(error.responseText);
            message = odataError?.error?.message?.value || message;
          } catch (e) {}
        }

        sap.m.MessageBox.error(message);

      } finally {
        oDialog.setBusy(false);
      }
    }
  });

  const oDialog = new sap.m.Dialog({
    title: "Confirm Upload",
    content: [oForm],
    beginButton: oUploadBtn,
    endButton: new sap.m.Button({
      text: "Cancel",
      press: () => oDialog.close()
    })
  });

  oDialog.open();
}
